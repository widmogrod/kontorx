#summary DataGrid example
#labels Phase-Deploy,Featured

= Introduction =

`KontorX_DataGrid`

== Example ==

=== Controller ===

controllers/IndexController.php

{{{

(...)
public function listAction() {
	$model = new Gallery_Model_Image();
	$table = $model->getDbTable();

	$rq = $this->getRequest();
	if ($rq->isPost()) {
		switch ($rq->getPost('action_type')) {
			case 'update':
				if (null !== $rq->getPost('editable')) {
					$data = $rq->getPost('editable');
					$model->editableUpdate($data);
					$this->_helper->flashMessenger($model->getStatus());
				}
				break;
			case 'delete':
				if (null !== $rq->getPost('action_checked')) {
					$data = $rq->getPost('action_checked');
					$model->editableDelete($data);
					$this->_helper->flashMessenger($model->getStatus());
				}
				break;
		}			
	}

	// setup data grid
	$config = $this->_helper->loader->config('image.xml');
	$grid = KontorX_DataGrid::factory($model->selectListGrid(), $config->grid);
	$grid->setValues($this->_getAllParams());

 	// $this->_setupDataGridPaginator($grid);
	
	$this->view->grid = $grid;
}

(...)
}}}

=== View ===
views/scripts/index/list.phtml

{{{
<?php
print $this->grid->render($this, '_partial/dataGrid.phtml');
}}}

views/scripts/`_`partial/dataGrid.phtml

{{{
<form action="" method="post">
<?php print $this->formSelect('action_type',null,null,array(
	'Wybierz akcje','update' => 'Aktualizuj', 'delete' => 'Usuń'
))?>
<?php print $this->formSubmit(null, 'Wykonaj akcje')?>
<table class="kontorx_dataorder">
	<thead>
		<tr>
			<?php foreach ($this->columns as $column): ?>
			<th class="<?php print $column->class ?>" rowspan="<?php print $column->rowspan ?>" style="<?php print $column->style ?>"><?php print $column ?></th>
			<?php endforeach; ?>
		</tr>
		<tr class="filters">
			<?php foreach ($this->filters as $filters): ?>
			<th>
				<?php foreach ($filters as $filter): ?>
				<span class="filter"><?php print $filter?></span>
				<?php endforeach; ?>
			</th>
			<?php endforeach; ?>
		</tr>
	</thead>
	<tbody>
		<?php foreach ($this->rowset as $row): ?>
		<tr class="<?php print $this->cycle(array('odd','even'))?>">
			<?php foreach ($row as $name): ?>
			<td><?php print $name;?></td>
			<?php endforeach; ?>
		</tr>
		<?php endforeach; ?>
	</tbody>
	<tfoot>
		<tr>
			<td colspan="<?php print count($this->columns) ?>">
				<?php if ($this->paginator): ?>
				<?php print $this->paginationControl($this->paginator, 'Sliding','_partial/pagination.phtml', array('valuesQuery' => $this->valuesQuery)); ?>
				<?php endif;?>
			</td>
		</tr>
	</tfoot>
</table>
</form>
}}}

=== Configuration  ===

DataGrid configuration file: _image.xml_

{{{
<?xml version="1.0" encoding="UTF-8"?>
<config>
	<grid>
		<prefixPaths>
			<prefixPath type="row" prefix="Promotor_DataGrid_Row_" path="Promotor/DataGrid/Row" />
		</prefixPaths>

		<RequestValues>GET</RequestValues>
        <columns>
        	<id type="Text" style="width:20px;" displayNone="1">
                <row type="Editable_FormCheckbox">
                	<primaryKey>id</primaryKey>
					<prefix>action_checked</prefix>
                </row>
            </id>
			<publicated type="Text" style="width:40px;">
				<name><![CDATA[<acronym title="Publikować">Pub</acronym>]]></name>
                <row type="Editable_YesNo">
                	<primaryKey>id</primaryKey>
                </row>
            </publicated>
			<image type="Text" name="Zdięcie" style="width:130px;">
                <row type="Html">
                	<content><![CDATA[<img src="upload/gallery/thumb/{image}" />]]></content>
                </row>
            </image>
			<name type="Text" name="Nazwa zdięcia">
                <filter type="Text"></filter>
                <row type="Editable_FormText">
                	<primaryKey>id</primaryKey>
                </row>
            </name>
			<album_name type="Text" name="Album">
				<filter type="Text"></filter>
			</album_name>
            <idx type="Order" name="Kolejność" style="width: 10px;">
                <row type="Editable_FormText">
                	<primaryKey>id</primaryKey>
                </row>
            </idx>
			<preview type="Text" style="width:30px;" displayNone="1">
                <row type="Url">
                	<name>Podgląd</name>
					<action>display</action>
                	<class>action arrow</class>
                	<primaryKey>id</primaryKey>
                </row>
            </preview>
			<edit type="Text" style="width:60px;" displayNone="1">
                <row type="Url">
                	<name>Edytuj</name>
					<action>edit</action>
                	<class>action edit</class>
                	<primaryKey>id</primaryKey>
                </row>
            </edit>
			<delete type="Text" style="width:20px;" displayNone="1">
                <row type="Url">
                	<name>Usuń</name>
					<action>delete</action>
                	<class>action trash ico</class>
                	<primaryKey>id</primaryKey>
                </row>
            </delete>
        </columns>
	</grid>
</config>
}}}